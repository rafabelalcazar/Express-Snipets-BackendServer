{
    // Place your snippets for javascript here. Each snippet is defined under a snippet name and has a prefix, body and 
    // description. The prefix is what is used to trigger the snippet and the body will be expanded and inserted. Possible variables are:
    // $1, $2 for tab stops, $0 for the final cursor position, and ${1:label}, ${2:another} for placeholders. Placeholders with the 
    // same ids are connected.
    // Example:
    // "Print to console": {
    // 	"prefix": "log",
    // 	"body": [
    // 		"console.log('$1');",
    // 		"$2"
    // 	],
    // 	"description": "Log output to console"
    // }

    "create a new express server": {
        "prefix": "serverExpress",
        "body": [
            "const express = require('express')",
            "const mongoose = require('mongoose');",
            "const bodyParser = require('body-parser')",
            "const PORT = process.env.PORT || 3000",
            "",
            "const app = express()",
            "",
            "// IMPORTS",
            "const ${1:route}Routes = require('./src/routes/${1:route}.routes')",
            "//const loginRoutes = require('./src/routes/login.routes')",
            "",
            "// DB connect",
            "mongoose.set('useCreateIndex', true)",
            "mongoose.connect('mongodb://localhost:27017/${2:nameDB}', { useNewUrlParser: true, useUnifiedTopology: true }, (err, res) => {",
            "    if (err) throw err",
            "    console.log('Conexion a base de datos:  \\x1b[32m%s\\x1b[0m','exitosa')",
            "})",
            "",
            "// MIDDLEWARE",
            "// parse application/x-www-form-urlencoded",
            "app.use(bodyParser.urlencoded({ extended: false }))",
            "// parse application/json",
            "app.use(bodyParser.json())",
            "",
            "// ROUTES",
            "app.use('/${1:route}', ${1:route}Routes)",
            "//app.use('/login', loginRoutes)",
            "",
            "app.listen(PORT, () => {",
            "    console.log('Servidor corriendo en puerto: \\x1b[4m\\x1b[32m%s\\x1b[0m', `http://localhost:\\${PORT}` );",
            "})",
        ],
        "description": "create a new express server @required npm i express mongoose bcryptjs jsonwebtoken --save "
    },
    "basicRouteExpress": {
        "prefix": "routeExpress",
        "body": [
            "const express = require('express')",
            "//var mdwareAuth = require('../middlewares/auth')",
            "",
            "var app = express()",
            "",
            "// IMPORTS",
            "const ${1:name}Controller = require('../controllers/${1:name}')",
            "",
            "// CRUD USERS",
            "app.get('/', ${1:name}Controller.showAll)",
            "app.post('/', ${1:name}Controller.create)",
            "app.put('/:id', ${1:name}Controller.update)",
            "app.delete('/:id', ${1:name}Controller.delete)",
            "",
            "module.exports = app",
        ],
        "description": "Rutas http get,post, put, delete"
    },
    "controllerExpress": {
        "prefix": "controllerExpress",
        "body": [
            "var ${1:nameModel} = require('../models/${2:fileModel}')",
            "const bcrypt = require('bcryptjs')",
            "const jwt = require('jsonwebtoken')",
            "",
            "var controller = {",
            "",
            "    showAll: (req, res) => {",
            "        ${1:nameModel}.find({}, (err, ${2:fileModel}s) => {",
            "            if (err) {",
            "                return res.status(500).json({",
            "                    ok: false,",
            "                    msg: 'Can´t get ${2:fileModel}s',",
            "                    err",
            "                })",
            "            }",
            "            res.status(200).json({",
            "                ok: true,",
            "                ${2:fileModel}s",
            "            })",
            "        })",
            "    },",
            "",
            "    create: (req, res) => {",
            "",
            "        var body = req.body",
            "",
            "        var ${2:fileModel} = new ${1:nameModel}({",
            "            name: body.name,",
            "            email: body.email,",
            "            password: bcrypt.hashSync(body.password, 10),",
            "        })",
            "",
            "        ${2:fileModel}.save((err, ${2:fileModel}Created) => {",
            "            if (err) {",
            "                return res.status(500).json({",
            "                    ok: false,",
            "                    msg: 'Can´t create ${2:fileModel}',",
            "                    err",
            "                })",
            "            }",
            "",
            "            res.status(201).json({",
            "                ok: true,",
            "                msg: '${2:fileModel} created',",
            "                ${2:fileModel}Created,",
            "                ${2:fileModel}Token: req.${2:fileModel}",
            "            })",
            "        })",
            "    },",
            "",
            "    update: (req, res) => {",
            "",
            "        const id = req.params.id",
            "        body = req.body",
            "",
            "        ${1:nameModel}.findById(id, (err, ${2:fileModel}) => {",
            "",
            "            if (err) {",
            "                return res.status(500).json({",
            "                    ok: false,",
            "                    msg: 'Can´t find the ${2:fileModel}',",
            "                    err",
            "                })",
            "            }",
            "",
            "            if (!${2:fileModel}) {",
            "                return res.status(400).json({",
            "                    ok: false,",
            "                    msg: `This ${2:fileModel} with this id ${ id } doesn´t exists`",
            "                })",
            "            }",
            "",
            "            ${2:fileModel}.name = body.name",
            "            ${2:fileModel}.email = body.email",
            "            ${2:fileModel}.password = body.password",
            "",
            "            ${2:fileModel}.save((err, ${2:fileModel}Saved) => {",
            "                if (err) {",
            "                    return res.status(500).json({",
            "                        ok: false,",
            "                        msg: `Error updating ${2:fileModel}`,",
            "                        err",
            "                    })",
            "                }",
            "",
            "                ${2:fileModel}Saved.password = ':)'",
            "",
            "                res.status(200).json({",
            "                    ok: true,",
            "                    msg: '${2:fileModel} updated',",
            "                    ${2:fileModel}Saved",
            "                })",
            "            })",
            "        })",
            "    },",
            "",
            "    delete: (req, res) => {",
            "",
            "        const id = req.params.id",
            "        //console.log(id);",
            "",
            "        ${1:nameModel}.findByIdAndDelete(id, (err, ${2:fileModel}Deleted) => {",
            "            if (err) {",
            "                return res.status(500).json({",
            "                    ok: false,",
            "                    msg: 'Error deleting ${2:fileModel}',",
            "                    err",
            "                })",
            "            }",
            "            if (!${2:fileModel}Deleted) {",
            "                return res.status(400).json({",
            "                    ok: false,",
            "                    msg: `This ${2:fileModel} with this id ${id} doesn´t exists `,",
            "                    err",
            "                })",
            "            }",
            "",
            "            ${2:fileModel}Deleted.password = ':)'",
            "",
            "            res.status(200).json({",
            "                ok: true,",
            "                msg: '${2:fileModel} deleted',",
            "                ${2:fileModel}Deleted",
            "            })",
            "        })",
            "    }",
            "}",
            "",
            "module.exports = controller",
        ],
        "description": "CRUD, controlador para implementar en rutas para metodos http get,post, put, delete"
    },
    "modelMongoose": {
        "prefix": "modelMongoose",
        "body": [
            "const mongoose = require('mongoose')",
            "const uniqueValidator = require('mongoose-unique-validator')",
            "",
            "const Schema = mongoose.Schema",
            "",
            "const roles = {",
            "    values: ['admin_role', 'user_role', 'client'],",
            "    message: '{VALUE} no es un rol valido'",
            "}",
            "",
            "var ${1:model}Schema = new Schema({",
            "    name: { type: String, required: [true, 'El nombre es requerido'] },",
            "    email: { type: String, required: [true, 'El correo es requerido'], unique: true },",
            "    password: { type: String, required: [true, 'La contraseña es requerida'] },",
            "    role: { type: String, default: 'client', enum: roles },",
            "})",
            "",
            "${1:model}Schema.plugin(uniqueValidator, { msg: '{PATH} debe ser único' })",
            "",
            "module.exports = mongoose.model('${2:Model}', ${1:model}Schema)",
        ],
        "description": "Create a Mongoose model"
    },
    "tokenMiddleware": {
        "prefix": "tokenMiddleware",
        "body": [
            "const jwt = require('jsonwebtoken')",
            "//var SEED = require('../../config').SEED",
            "var SEED = ${1:SEED}",
            "",
            "// TOKEN VALIDATE",
            "exports.validateToken = function(req, res, next) {",
            "",
            "    var token = req.query.token",
            "",
            "    jwt.verify(token, SEED, (err, decoded) => {",
            "        if (err) {",
            "            return res.status(401).json({",
            "                ok: false,",
            "                msg: 'Token incorrecto',",
            "                errors: err",
            "            })",
            "        }",
            "",
            "        req.user = decoded.user",
            "",
            "        next()",
            "    })",
            "}",
        ],
        "description": "Create authentication with json web token"
    }

}